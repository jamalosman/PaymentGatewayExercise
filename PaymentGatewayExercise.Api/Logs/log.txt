2021-02-01 08:51:39.766 +00:00 [INF] Starting web host
2021-02-01 08:51:41.040 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 08:51:41.252 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 08:51:41.264 +00:00 [INF] Bus Rebus 1 started
2021-02-01 08:51:41.267 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 08:51:41.271 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 08:51:41.284 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 08:51:41.312 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 08:51:41.702 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 08:51:41.721 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 08:51:41.723 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 08:51:41.723 +00:00 [INF] Hosting environment: Development
2021-02-01 08:51:41.724 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 08:51:43.247 +00:00 [INF] HTTP GET / responded 404 in 1.3412 ms
2021-02-01 08:51:52.738 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 08:51:52.877 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 08:51:53.768 +00:00 [INF] Executed DbCommand (62ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 08:51:53.959 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-02-01 08:53:25.371 +00:00 [INF] Starting web host
2021-02-01 08:53:26.507 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 08:53:26.709 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 08:53:26.718 +00:00 [INF] Bus Rebus 1 started
2021-02-01 08:53:26.720 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 08:53:26.722 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 08:53:26.733 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 08:53:26.774 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 08:53:27.073 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 08:53:27.077 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 08:53:27.079 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 08:53:27.080 +00:00 [INF] Hosting environment: Production
2021-02-01 08:53:27.081 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 08:53:28.446 +00:00 [INF] HTTP GET / responded 404 in 1.4668 ms
2021-02-01 08:53:35.657 +00:00 [INF] HTTP GET / responded 404 in 0.0407 ms
2021-02-01 08:53:52.980 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 08:53:53.118 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 08:53:53.897 +00:00 [INF] Executed DbCommand (56ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 08:53:54.069 +00:00 [ERR] Connection id "0HM66HRBM5D6A", Request id "0HM66HRBM5D6A:00000001": An unhandled exception was thrown by the application.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 08:55:08.914 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 08:55:08.929 +00:00 [INF] Executed DbCommand (8ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 08:57:11.782 +00:00 [ERR] Connection id "0HM66HRBM5D6A", Request id "0HM66HRBM5D6A:00000002": An unhandled exception was thrown by the application.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 09:08:46.617 +00:00 [INF] Starting web host
2021-02-01 09:08:47.812 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:08:47.994 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:08:48.003 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:08:48.006 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:08:48.008 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:08:48.019 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:08:48.065 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:08:48.388 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:08:48.393 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:08:48.395 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:08:48.396 +00:00 [INF] Hosting environment: Production
2021-02-01 09:08:48.396 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:08:49.927 +00:00 [INF] HTTP GET / responded 404 in 1.3954 ms
2021-02-01 09:09:40.387 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:09:40.512 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:09:41.361 +00:00 [INF] Executed DbCommand (74ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:09:41.542 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:09:41.634 +00:00 [DBG] Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:15:10.018 +00:00 [INF] Starting web host
2021-02-01 09:15:11.526 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:15:11.747 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:15:11.755 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:15:11.758 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:15:11.760 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:15:11.769 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:15:11.804 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:15:12.143 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:15:12.146 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:15:12.147 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:15:12.148 +00:00 [INF] Hosting environment: Production
2021-02-01 09:15:12.148 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:15:13.677 +00:00 [INF] HTTP GET / responded 404 in 2.6493 ms
2021-02-01 09:15:34.765 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:15:34.890 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:15:35.686 +00:00 [INF] Executed DbCommand (55ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:15:35.881 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:15:35.968 +00:00 [DBG] Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:25:02.900 +00:00 [INF] Starting web host
2021-02-01 09:25:49.229 +00:00 [INF] Starting web host
2021-02-01 09:25:56.719 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:25:57.417 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:25:57.447 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:25:57.451 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:25:57.457 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:25:57.473 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:25:57.546 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:25:58.159 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:25:58.166 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:25:58.169 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:25:58.172 +00:00 [INF] Hosting environment: Production
2021-02-01 09:25:58.174 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:25:59.965 +00:00 [INF] HTTP GET / responded 404 in 3.8895 ms
2021-02-01 09:33:28.058 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:33:28.216 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:33:29.010 +00:00 [INF] Executed DbCommand (57ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:33:29.190 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:33:29.274 +00:00 [INF] HTTP GET /api/payments?paymentId=DE7DB63B-9AAE-48D4-B290-5EBD144D80DC responded 404 in 0.0121 ms
2021-02-01 09:34:43.782 +00:00 [INF] Starting web host
2021-02-01 09:34:45.070 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:34:45.279 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:34:45.287 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:34:45.289 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:34:45.291 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:34:45.300 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:34:45.341 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:34:45.653 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:34:45.656 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:34:45.658 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:34:45.659 +00:00 [INF] Hosting environment: Production
2021-02-01 09:34:45.660 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:34:47.092 +00:00 [INF] HTTP GET / responded 404 in 2.7042 ms
2021-02-01 09:35:00.237 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:35:00.374 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:35:01.163 +00:00 [INF] Executed DbCommand (67ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:35:01.420 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:35:01.565 +00:00 [INF] HTTP GET /api/payments?paymentId=DE7DB63B-9AAE-48D4-B290-5EBD144D80DC responded 404 in 0.0229 ms
2021-02-01 09:37:41.137 +00:00 [INF] Starting web host
2021-02-01 09:37:42.476 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:37:42.752 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:37:42.769 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:37:42.770 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:37:42.772 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:37:42.782 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:37:42.824 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:37:43.086 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:37:43.089 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:37:43.090 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:37:43.091 +00:00 [INF] Hosting environment: Production
2021-02-01 09:37:43.092 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:37:44.330 +00:00 [INF] HTTP GET / responded 404 in 1.8133 ms
2021-02-01 09:38:00.689 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:38:00.817 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:38:01.588 +00:00 [INF] Executed DbCommand (55ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:38:01.773 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:38:01.858 +00:00 [INF] HTTP GET /api/payments?paymentId=DE7DB63B-9AAE-48D4-B290-5EBD144D80DC responded 404 in 0.0202 ms
2021-02-01 09:38:27.880 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:38:27.895 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:38:28.016 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:38:28.026 +00:00 [INF] HTTP GET /api/payments?paymentId=DE7DB63B-9AAE-48D4-B290-5EBD144D80DC responded 404 in 0.0138 ms
2021-02-01 09:39:05.712 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:39:05.722 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:39:08.750 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:39:08.763 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 09:39:08.873 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id de7db63b-9aae-48d4-b290-5ebd144d80dc
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 57
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:39:08.884 +00:00 [INF] HTTP GET /api/payments?paymentId=DE7DB63B-9AAE-48D4-B290-5EBD144D80DC responded 404 in 0.0124 ms
2021-02-01 09:39:22.305 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:39:22.608 +00:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payment] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payment]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 09:39:22.881 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 09:39:22.896 +00:00 [DBG] Initializing new model
2021-02-01 09:39:22.936 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payment] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 09:39:22.999 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:39:23.013 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 09:39:59.697 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:39:59.707 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 09:39:59.818 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:39:59.837 +00:00 [INF] HTTP GET /api/payments/1000 responded 404 in 0.0170 ms
2021-02-01 09:40:53.125 +00:00 [INF] Starting web host
2021-02-01 09:40:54.655 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:40:54.871 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:40:54.880 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:40:54.882 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:40:54.883 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:40:54.892 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:40:54.931 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:40:55.315 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:40:55.319 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:40:55.321 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:40:55.323 +00:00 [INF] Hosting environment: Production
2021-02-01 09:40:55.325 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:40:56.515 +00:00 [INF] HTTP GET / responded 404 in 1.0495 ms
2021-02-01 09:40:56.987 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:40:57.140 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:40:57.900 +00:00 [INF] Executed DbCommand (61ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 09:40:58.101 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:41:01.914 +00:00 [DBG] Could not find Payment with id 1000
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:41:51.260 +00:00 [INF] Starting web host
2021-02-01 09:41:52.813 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:41:53.083 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:41:53.095 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:41:53.098 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:41:53.102 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:41:53.114 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:41:53.151 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:41:53.629 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:41:53.632 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:41:53.633 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:41:53.634 +00:00 [INF] Hosting environment: Production
2021-02-01 09:41:53.635 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:41:54.828 +00:00 [INF] HTTP GET / responded 404 in 2.9743 ms
2021-02-01 09:42:10.595 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:42:22.995 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:42:23.751 +00:00 [INF] Executed DbCommand (56ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 09:42:23.933 +00:00 [ERR] An unhandled exception has occurred while executing the request.
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:42:24.018 +00:00 [DBG] Could not find Payment with id 1000
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 09:52:49.319 +00:00 [INF] Starting web host
2021-02-01 09:52:50.587 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 09:52:50.794 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 09:52:50.802 +00:00 [INF] Bus Rebus 1 started
2021-02-01 09:52:50.804 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 09:52:50.806 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 09:52:50.817 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 09:52:50.889 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 09:52:51.232 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 09:52:51.236 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 09:52:51.239 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 09:52:51.240 +00:00 [INF] Hosting environment: Production
2021-02-01 09:52:51.241 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 09:52:52.505 +00:00 [INF] HTTP GET / responded 404 in 1.4071 ms
2021-02-01 09:52:59.017 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 09:52:59.161 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 09:52:59.924 +00:00 [INF] Executed DbCommand (63ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payment] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 09:53:00.137 +00:00 [DBG] Could not find Payment with id 1000
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 1000
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 48
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 10:28:13.949 +00:00 [INF] Starting web host
2021-02-01 10:28:15.666 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:28:15.909 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:28:15.946 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:28:15.949 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:28:15.951 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:28:15.963 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:28:16.004 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:28:16.507 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:28:16.509 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:28:16.510 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:28:16.511 +00:00 [INF] Hosting environment: Production
2021-02-01 10:28:16.512 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:28:18.279 +00:00 [INF] HTTP GET / responded 404 in 1.7840 ms
2021-02-01 10:28:19.109 +00:00 [INF] HTTP GET / responded 404 in 0.0374 ms
2021-02-01 10:28:20.482 +00:00 [INF] HTTP GET / responded 404 in 0.0928 ms
2021-02-01 10:28:20.968 +00:00 [INF] HTTP GET / responded 404 in 0.0855 ms
2021-02-01 10:28:21.333 +00:00 [INF] HTTP GET / responded 404 in 0.0708 ms
2021-02-01 10:30:05.950 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:30:05.963 +00:00 [DBG] Initializing new model
2021-02-01 10:30:06.066 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 4d1df685-dc4f-440d-9b23-18cc15b04c45
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 4d1df685-dc4f-440d-9b23-18cc15b04c45 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:30:06.143 +00:00 [ERR] Moving message with ID 4d1df685-dc4f-440d-9b23-18cc15b04c45 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 4d1df685-dc4f-440d-9b23-18cc15b04c45 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 4d1df685-dc4f-440d-9b23-18cc15b04c45 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:30:06.913 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:30:07.184 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:30:07.725 +00:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:30:07.824 +00:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:30:07.835 +00:00 [ERR] Health check sql_healthcheck completed after 1870.4458ms with status "Unhealthy" and 'null'
2021-02-01 10:30:12.340 +00:00 [INF] HTTP GET /health/bus_healthcheck responded 404 in 0.0451 ms
2021-02-01 10:30:18.651 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:30:18.658 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:30:18.670 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID c40a6cdc-ad62-4715-bd61-03dbf66e9446
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID c40a6cdc-ad62-4715-bd61-03dbf66e9446 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:30:18.701 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:30:18.711 +00:00 [ERR] Moving message with ID c40a6cdc-ad62-4715-bd61-03dbf66e9446 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID c40a6cdc-ad62-4715-bd61-03dbf66e9446 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID c40a6cdc-ad62-4715-bd61-03dbf66e9446 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:30:18.722 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:30:18.749 +00:00 [ERR] Health check sql_healthcheck completed after 98.259ms with status "Unhealthy" and 'null'
2021-02-01 10:30:19.111 +00:00 [INF] HTTP GET /favicon.ico responded 404 in 0.0348 ms
2021-02-01 10:33:03.969 +00:00 [INF] Starting web host
2021-02-01 10:33:05.373 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:33:05.599 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:33:05.620 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:33:05.622 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:33:05.624 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:33:05.635 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:33:05.689 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:33:06.045 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:33:06.049 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:33:06.051 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:33:06.053 +00:00 [INF] Hosting environment: Production
2021-02-01 10:33:06.055 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:33:07.654 +00:00 [INF] HTTP GET / responded 404 in 1.5929 ms
2021-02-01 10:33:18.439 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:33:18.455 +00:00 [DBG] Initializing new model
2021-02-01 10:33:18.588 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID facc45fa-bc3a-4247-8c63-a75e329ae6ba
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID facc45fa-bc3a-4247-8c63-a75e329ae6ba and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:33:18.666 +00:00 [ERR] Moving message with ID facc45fa-bc3a-4247-8c63-a75e329ae6ba to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID facc45fa-bc3a-4247-8c63-a75e329ae6ba and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID facc45fa-bc3a-4247-8c63-a75e329ae6ba and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:33:19.324 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:33:19.333 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID e41f9309-afb1-4101-8655-3e15b0a7e994
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID e41f9309-afb1-4101-8655-3e15b0a7e994 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:33:19.357 +00:00 [ERR] Moving message with ID e41f9309-afb1-4101-8655-3e15b0a7e994 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID e41f9309-afb1-4101-8655-3e15b0a7e994 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID e41f9309-afb1-4101-8655-3e15b0a7e994 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:33:19.642 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:33:19.820 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:33:19.820 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:33:20.613 +00:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:33:20.613 +00:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:33:20.691 +00:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:33:20.691 +00:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:33:20.706 +00:00 [ERR] Health check sql_healthcheck completed after 1378.127ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:33:20.706 +00:00 [ERR] Health check sql_healthcheck completed after 2248.1809ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:33:21.037 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:33:21.046 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 9af8c0b3-f544-4f01-b7fa-ef90131d79bf
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 9af8c0b3-f544-4f01-b7fa-ef90131d79bf and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:33:21.062 +00:00 [ERR] Moving message with ID 9af8c0b3-f544-4f01-b7fa-ef90131d79bf to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 9af8c0b3-f544-4f01-b7fa-ef90131d79bf and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 9af8c0b3-f544-4f01-b7fa-ef90131d79bf and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:33:21.086 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:33:21.099 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:33:21.108 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:33:21.112 +00:00 [ERR] Health check sql_healthcheck completed after 71.9683ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:33:25.789 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:33:25.791 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:33:25.801 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 49744212-5bed-429b-88cd-232f5ca7cc2d
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 49744212-5bed-429b-88cd-232f5ca7cc2d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:33:25.804 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:33:25.828 +00:00 [ERR] Moving message with ID 49744212-5bed-429b-88cd-232f5ca7cc2d to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 49744212-5bed-429b-88cd-232f5ca7cc2d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 49744212-5bed-429b-88cd-232f5ca7cc2d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:33:25.832 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:33:25.854 +00:00 [ERR] Health check sql_healthcheck completed after 64.5559ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:33:34.455 +00:00 [INF] HTTP GET /health/bus_healthcheck responded 404 in 0.0470 ms
2021-02-01 10:33:36.340 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:33:36.343 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:33:36.356 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID a9103265-0e22-4b88-b774-73c6e13c60ee
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID a9103265-0e22-4b88-b774-73c6e13c60ee and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:33:36.359 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:33:36.371 +00:00 [ERR] Moving message with ID a9103265-0e22-4b88-b774-73c6e13c60ee to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID a9103265-0e22-4b88-b774-73c6e13c60ee and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID a9103265-0e22-4b88-b774-73c6e13c60ee and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:33:36.382 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:33:36.400 +00:00 [ERR] Health check sql_healthcheck completed after 60.9762ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:33:39.378 +00:00 [INF] HTTP GET /health/bus_healthcheck responded 404 in 0.1330 ms
2021-02-01 10:40:11.418 +00:00 [INF] Starting web host
2021-02-01 10:40:12.985 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:40:13.234 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:40:13.245 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:40:13.248 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:40:13.251 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:40:13.265 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:40:13.325 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:40:13.765 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:40:13.767 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:40:13.768 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:40:13.769 +00:00 [INF] Hosting environment: Production
2021-02-01 10:40:13.770 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:40:15.154 +00:00 [INF] HTTP GET / responded 404 in 1.5233 ms
2021-02-01 10:40:26.391 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:40:26.406 +00:00 [DBG] Initializing new model
2021-02-01 10:40:26.515 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 1b7367d7-8cd1-428f-9bdc-a10e4480a9da
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 1b7367d7-8cd1-428f-9bdc-a10e4480a9da and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:40:26.578 +00:00 [ERR] Moving message with ID 1b7367d7-8cd1-428f-9bdc-a10e4480a9da to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 1b7367d7-8cd1-428f-9bdc-a10e4480a9da and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 1b7367d7-8cd1-428f-9bdc-a10e4480a9da and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:40:27.132 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:40:27.316 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:40:27.694 +00:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:40:27.807 +00:00 [INF] Executed DbCommand (91ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:40:27.851 +00:00 [ERR] Health check sql_healthcheck completed after 1434.7284ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:41:06.322 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:41:19.491 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:41:27.581 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 9bd739f2-2b52-4e58-89f0-0f607a21af76
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 9bd739f2-2b52-4e58-89f0-0f607a21af76 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:42:18.874 +00:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:41:27.587 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:42:18.897 +00:00 [ERR] Moving message with ID 9bd739f2-2b52-4e58-89f0-0f607a21af76 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 9bd739f2-2b52-4e58-89f0-0f607a21af76 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 9bd739f2-2b52-4e58-89f0-0f607a21af76 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:42:18.909 +00:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:42:18.917 +00:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:42:18.931 +00:00 [ERR] Health check sql_healthcheck completed after 72608.0848ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:42:33.307 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:42:59.149 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 7fa25540-8975-470a-a576-419e3f556f3d
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 7fa25540-8975-470a-a576-419e3f556f3d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:42:59.156 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:42:59.160 +00:00 [ERR] Moving message with ID 7fa25540-8975-470a-a576-419e3f556f3d to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 7fa25540-8975-470a-a576-419e3f556f3d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 7fa25540-8975-470a-a576-419e3f556f3d and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:42:59.180 +00:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:42:59.185 +00:00 [ERR] Health check sql_healthcheck completed after 25874.287ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:44:04.402 +00:00 [INF] Starting web host
2021-02-01 10:44:05.692 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:44:05.893 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:44:05.907 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:44:05.908 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:44:05.909 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:44:05.918 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:44:05.955 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:44:06.279 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:44:06.282 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:44:06.283 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:44:06.284 +00:00 [INF] Hosting environment: Production
2021-02-01 10:44:06.285 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:44:07.594 +00:00 [INF] HTTP GET / responded 404 in 1.4907 ms
2021-02-01 10:44:10.566 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:44:10.578 +00:00 [DBG] Initializing new model
2021-02-01 10:44:10.676 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 868da36c-8d7f-4994-8b20-499d4f976880
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 868da36c-8d7f-4994-8b20-499d4f976880 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:44:10.737 +00:00 [ERR] Moving message with ID 868da36c-8d7f-4994-8b20-499d4f976880 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 868da36c-8d7f-4994-8b20-499d4f976880 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 868da36c-8d7f-4994-8b20-499d4f976880 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:44:11.229 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:44:11.355 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:44:11.717 +00:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:44:11.780 +00:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:44:11.792 +00:00 [ERR] Health check sql_healthcheck completed after 1209.7055ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:44:48.471 +00:00 [INF] Starting web host
2021-02-01 10:44:50.775 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:44:51.065 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:44:51.094 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:44:51.098 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:44:51.100 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:44:51.118 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:44:51.212 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:44:51.938 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:44:51.942 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:44:51.944 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:44:51.946 +00:00 [INF] Hosting environment: Production
2021-02-01 10:44:51.952 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:44:52.646 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:44:52.674 +00:00 [DBG] Initializing new model
2021-02-01 10:44:52.873 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 653242c8-2975-4135-ae1e-b90a958ce009
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 653242c8-2975-4135-ae1e-b90a958ce009 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:44:52.975 +00:00 [ERR] Moving message with ID 653242c8-2975-4135-ae1e-b90a958ce009 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 653242c8-2975-4135-ae1e-b90a958ce009 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 653242c8-2975-4135-ae1e-b90a958ce009 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:44:53.253 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:44:53.280 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID 2cbce0ee-4b11-4d3d-bd80-b161909d1d7f
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 2cbce0ee-4b11-4d3d-bd80-b161909d1d7f and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:44:53.322 +00:00 [ERR] Moving message with ID 2cbce0ee-4b11-4d3d-bd80-b161909d1d7f to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID 2cbce0ee-4b11-4d3d-bd80-b161909d1d7f and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID 2cbce0ee-4b11-4d3d-bd80-b161909d1d7f and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:44:53.715 +00:00 [INF] HTTP GET / responded 404 in 4.9617 ms
2021-02-01 10:44:54.166 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:44:54.343 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:44:54.343 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:44:54.773 +00:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:44:54.773 +00:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:44:54.833 +00:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:44:54.833 +00:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:45:32.212 +00:00 [INF] Starting web host
2021-02-01 10:45:35.083 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:45:35.519 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:45:35.536 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:45:35.539 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:45:35.542 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:45:35.563 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:45:35.661 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:45:36.261 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:45:36.276 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:45:36.291 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:45:36.293 +00:00 [INF] Hosting environment: Production
2021-02-01 10:45:36.298 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:45:38.615 +00:00 [INF] HTTP GET / responded 404 in 3.3372 ms
2021-02-01 10:45:41.094 +00:00 [INF] HTTP GET / responded 404 in 0.0327 ms
2021-02-01 10:45:52.957 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:45:52.970 +00:00 [DBG] Initializing new model
2021-02-01 10:45:53.064 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID a44588ed-aca6-4577-b96b-cc58b154437b
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID a44588ed-aca6-4577-b96b-cc58b154437b and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:45:53.124 +00:00 [ERR] Moving message with ID a44588ed-aca6-4577-b96b-cc58b154437b to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID a44588ed-aca6-4577-b96b-cc58b154437b and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID a44588ed-aca6-4577-b96b-cc58b154437b and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:45:53.616 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:45:53.738 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:45:54.084 +00:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 10:45:54.153 +00:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2021-02-01 10:46:04.802 +00:00 [ERR] Health check sql_healthcheck completed after 11805.2984ms with status "Unhealthy" and 'SQL Server Unhealthy'
2021-02-01 10:47:16.458 +00:00 [INF] Starting web host
2021-02-01 10:47:17.931 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 10:47:18.146 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 10:47:18.158 +00:00 [INF] Bus Rebus 1 started
2021-02-01 10:47:18.160 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 10:47:18.162 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 10:47:18.171 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 10:47:18.226 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 10:47:18.601 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 10:47:18.605 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 10:47:18.607 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 10:47:18.609 +00:00 [INF] Hosting environment: Production
2021-02-01 10:47:18.610 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 10:47:19.824 +00:00 [INF] HTTP GET / responded 404 in 2.0122 ms
2021-02-01 10:47:25.292 +00:00 [DBG] Sending HealthCheck message -> PaymentsDefaultQueue
2021-02-01 10:47:25.305 +00:00 [DBG] Initializing new model
2021-02-01 10:47:25.404 +00:00 [WRN] Unhandled exception 1 (FINAL) while handling message with ID f7d8b88d-4460-41f9-b9e6-561aaea8b526
Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID f7d8b88d-4460-41f9-b9e6-561aaea8b526 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
2021-02-01 10:47:25.465 +00:00 [ERR] Moving message with ID f7d8b88d-4460-41f9-b9e6-561aaea8b526 to error queue error
System.AggregateException: 1 unhandled exceptions (Message with ID f7d8b88d-4460-41f9-b9e6-561aaea8b526 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings))
 ---> Rebus.Exceptions.MessageCouldNotBeDispatchedToAnyHandlersException: Message with ID f7d8b88d-4460-41f9-b9e6-561aaea8b526 and type System.String, mscorlib could not be dispatched to any handlers (and will not be retried under the default fail-fast settings)
   at Rebus.Pipeline.Receive.DispatchIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Sagas.LoadSagaDataStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.ActivateHandlersStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleRoutingSlipsStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.DeserializeIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.DataBus.ClaimCheck.HydrateIncomingMessageStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Pipeline.Receive.HandleDeferredMessagesStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.FailFast.FailFastStep.Process(IncomingStepContext context, Func`1 next)
   at Rebus.Retry.Simple.SimpleRetryStrategyStep.DispatchWithTrackerIdentifier(Func`1 next, String identifierToTrackMessageBy, ITransactionContext transactionContext, String messageId, String secondLevelMessageId)
   --- End of inner exception stack trace ---
2021-02-01 10:47:25.954 +00:00 [WRN] No type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType()', specify precision and scale using 'HasPrecision()' or configure a value converter using 'HasConversion()'.
2021-02-01 10:47:26.090 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 10:47:26.461 +00:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2021-02-01 15:41:49.842 +00:00 [INF] Starting web host
2021-02-01 15:41:53.603 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 15:41:54.179 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 15:41:54.229 +00:00 [INF] Bus Rebus 1 started
2021-02-01 15:41:54.235 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 15:41:54.241 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 15:41:54.262 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 15:41:54.418 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 15:41:55.380 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 15:41:55.390 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 15:41:55.395 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 15:41:55.401 +00:00 [INF] Hosting environment: Production
2021-02-01 15:41:55.404 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 15:41:58.607 +00:00 [INF] No Api Key found in the request.
2021-02-01 15:41:58.668 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 15:41:58.738 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 15:42:18.257 +00:00 [INF] No Api Key found in the request.
2021-02-01 15:42:18.313 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 15:42:18.329 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:08:08.319 +00:00 [INF] Starting web host
2021-02-01 16:08:12.422 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:08:12.832 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:08:12.850 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:08:12.854 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:08:12.858 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:08:12.876 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:08:12.949 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:08:13.579 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:08:13.586 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:08:13.590 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:08:13.593 +00:00 [INF] Hosting environment: Production
2021-02-01 16:08:13.595 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:08:16.894 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:08:16.986 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:08:17.108 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:08:25.706 +00:00 [ERR] Connection id "0HM66PE9VLQNT", Request id "0HM66PE9VLQNT:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: Unable to resolve service for type 'PaymentGateway.Services.Interfaces.ISecurityService' while attempting to activate 'PaymentGateway.PaymentGatewayApiKeyProvider'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.ValidateUsingApiKeyProviderAsync(String apiKey)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.AuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationService.AuthenticateAsync(HttpContext context, String scheme)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 16:09:35.755 +00:00 [INF] Starting web host
2021-02-01 16:09:38.642 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:09:39.083 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:09:39.137 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:09:39.143 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:09:39.146 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:09:39.166 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:09:39.260 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:09:39.922 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:09:39.926 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:09:39.928 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:09:39.929 +00:00 [INF] Hosting environment: Production
2021-02-01 16:09:39.930 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:09:42.362 +00:00 [ERR] Connection id "0HM66PF3PDIQG", Request id "0HM66PF3PDIQG:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: Unable to resolve service for type 'PaymentGateway.Services.Interfaces.ISecurityService' while attempting to activate 'PaymentGateway.PaymentGatewayApiKeyProvider'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.ValidateUsingApiKeyProviderAsync(String apiKey)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.AuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationService.AuthenticateAsync(HttpContext context, String scheme)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 16:09:42.572 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:09:42.770 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:09:42.827 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:11:05.357 +00:00 [INF] Starting web host
2021-02-01 16:11:08.655 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:11:08.999 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:11:09.017 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:11:09.023 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:11:09.028 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:11:09.042 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:11:09.120 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:11:09.627 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:11:09.633 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:11:09.635 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:11:09.637 +00:00 [INF] Hosting environment: Production
2021-02-01 16:11:09.639 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:11:12.016 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:11:12.036 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:11:12.073 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:11:21.951 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:11:23.145 +00:00 [ERR] Failed executing DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:11:23.264 +00:00 [ERR] An exception occurred while iterating over the results of a query for context type 'PaymentGateway.Data.PaymentsContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Merchants'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:0221167d-5edb-4aad-b28d-89d8ae79096b
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Merchants'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:0221167d-5edb-4aad-b28d-89d8ae79096b
Error Number:208,State:1,Class:16
2021-02-01 16:14:42.635 +00:00 [INF] Starting web host
2021-02-01 16:14:44.581 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:14:44.852 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:14:44.871 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:14:44.878 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:14:44.883 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:14:44.896 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:14:44.955 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:14:45.409 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:14:45.414 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:14:45.417 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:14:45.419 +00:00 [INF] Hosting environment: Production
2021-02-01 16:14:45.421 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:14:47.293 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:14:47.309 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:14:47.330 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:15:09.538 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:15:10.229 +00:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:15:10.568 +00:00 [INF] Executed DbCommand (39ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 16:15:10.616 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 16:15:10.821 +00:00 [INF] Executed DbCommand (33ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:15:10.851 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:15:10.861 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:15:10.866 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:15:19.491 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:15:19.499 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:15:19.513 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:15:19.517 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:15:19.518 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:15:19.520 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:15:46.993 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:15:47.000 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:15:51.162 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:16:10.273 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:16:10.285 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 16:16:10.290 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:16:15.541 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:16:15.548 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:17:31.227 +00:00 [INF] Starting web host
2021-02-01 16:17:33.483 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:17:33.701 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:17:33.712 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:17:33.715 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:17:33.718 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:17:33.730 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:17:33.788 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:17:34.249 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:17:34.254 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:17:34.255 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:17:34.256 +00:00 [INF] Hosting environment: Production
2021-02-01 16:17:34.258 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:17:36.252 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:17:36.263 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:17:36.278 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:18:00.629 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:18:01.390 +00:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:19:09.257 +00:00 [INF] Starting web host
2021-02-01 16:19:11.143 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:19:11.368 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:19:11.385 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:19:11.388 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:19:11.390 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:19:11.402 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:19:11.453 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:19:11.802 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:19:11.806 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:19:11.809 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:19:11.811 +00:00 [INF] Hosting environment: Production
2021-02-01 16:19:11.813 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:19:13.590 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:19:13.605 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:19:13.626 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:19:24.162 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:19:24.803 +00:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:22:13.706 +00:00 [INF] Starting web host
2021-02-01 16:22:16.917 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:22:17.248 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:22:17.265 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:22:17.270 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:22:17.272 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:22:17.288 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:22:17.388 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:22:17.978 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:22:17.988 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:22:18.050 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:22:18.080 +00:00 [INF] Hosting environment: Production
2021-02-01 16:22:18.082 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:22:19.608 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:22:19.625 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:22:19.652 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:22:20.185 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:22:20.986 +00:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:22:50.707 +00:00 [INF] Starting web host
2021-02-01 16:22:52.531 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:22:52.753 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:22:52.778 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:22:52.780 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:22:52.782 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:22:52.794 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:22:52.848 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:22:53.168 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:22:53.171 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:22:53.172 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:22:53.173 +00:00 [INF] Hosting environment: Production
2021-02-01 16:22:53.174 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:22:54.829 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:22:54.841 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:22:54.856 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:23:00.977 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:23:01.586 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:23:08.031 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:23:28.196 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:23:28.204 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:23:28.209 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:23:28.413 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:23:28.418 +00:00 [DBG] Validation failed: 
 -- MerchantId: 'Merchant Id' must be greater than '0'.
FluentValidation.ValidationException: Validation failed: 
 -- MerchantId: 'Merchant Id' must be greater than '0'.
   at FluentValidation.AbstractValidator`1.RaiseValidationException(ValidationContext`1 context, ValidationResult result) in /home/jskinner/code/FluentValidation/src/FluentValidation/AbstractValidator.cs:line 375
   at FluentValidation.AbstractValidator`1.Validate(ValidationContext`1 context) in /home/jskinner/code/FluentValidation/src/FluentValidation/AbstractValidator.cs:line 114
   at FluentValidation.AbstractValidator`1.FluentValidation.IValidator.Validate(IValidationContext context) in /home/jskinner/code/FluentValidation/src/FluentValidation/AbstractValidator.cs:line 48
   at FluentValidation.DefaultValidatorExtensions.Validate[T](IValidator`1 validator, T instance, Action`1 options) in /home/jskinner/code/FluentValidation/src/FluentValidation/DefaultValidatorExtensions_Validate.cs:line 39
   at PaymentGateway.Services.Extensions.ValidationExtensions.ValidateForServices[T](AbstractValidator`1 validator, T model) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Extensions\ValidationExtensions.cs:line 13
   at PaymentGateway.Services.Services.PaymentService.SubmitPayment(PaymentRequestModel requestModel) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 63
   at PaymentGateway.Api.Controllers.PaymentsController.SubmitPayment(PaymentRequestModel model) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 26
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 16:38:04.133 +00:00 [INF] Starting web host
2021-02-01 16:38:07.442 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:38:07.989 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:38:08.035 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:38:08.041 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:38:08.046 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:38:08.067 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:38:08.183 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:38:08.857 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:38:08.863 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:38:08.865 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:38:08.866 +00:00 [INF] Hosting environment: Production
2021-02-01 16:38:08.869 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:38:11.387 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:38:11.411 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:38:11.446 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:38:21.518 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:38:22.994 +00:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:38:23.075 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:38:24.055 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:38:24.067 +00:00 [ERR] Only merchants can make payments
PaymentGateway.Services.Exceptions.UnauthorizedResourceAccessException: Only merchants can make payments
   at PaymentGateway.Services.Services.PaymentService.SubmitPayment(PaymentRequestModel requestModel) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 73
   at PaymentGateway.Api.Controllers.PaymentsController.SubmitPayment(PaymentRequestModel model) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 26
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 16:38:37.558 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:38:37.575 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:38:37.881 +00:00 [INF] Executed DbCommand (82ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:38:38.072 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:38:38.807 +00:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 16:38:39.372 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 16:38:39.423 +00:00 [DBG] Initializing new model
2021-02-01 16:38:39.497 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 16:38:39.655 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:38:39.667 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:38:39.691 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:38:39.700 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:38:39.779 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 16:55:41.039 +00:00 [INF] Starting web host
2021-02-01 16:55:44.612 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 16:55:45.234 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 16:55:45.262 +00:00 [INF] Bus Rebus 1 started
2021-02-01 16:55:45.268 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 16:55:45.275 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 16:55:45.316 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 16:55:45.445 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 16:55:46.651 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 16:55:46.996 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 16:55:47.028 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 16:55:47.037 +00:00 [INF] Hosting environment: Production
2021-02-01 16:55:47.040 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 16:55:50.710 +00:00 [INF] No Api Key found in the request.
2021-02-01 16:55:50.762 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 16:55:50.816 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 16:56:21.113 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:56:22.012 +00:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:56:22.232 +00:00 [INF] Executed DbCommand (52ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:56:22.338 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:56:23.310 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 16:56:23.555 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 16:56:23.609 +00:00 [DBG] Initializing new model
2021-02-01 16:56:23.682 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 16:56:23.825 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 16:56:23.832 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 16:56:23.844 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 16:56:23.850 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 16:56:23.880 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 21:02:28.253 +00:00 [INF] Starting web host
2021-02-01 21:02:29.910 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:02:30.099 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:02:30.109 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:02:30.111 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:02:30.113 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:02:30.123 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:02:30.191 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:02:30.487 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:02:30.490 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:02:30.490 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:02:30.491 +00:00 [INF] Hosting environment: Production
2021-02-01 21:02:30.492 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:02:32.319 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:02:32.335 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:02:32.353 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:02:38.682 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:02:39.264 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:04:14.258 +00:00 [INF] Starting web host
2021-02-01 21:04:15.624 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:04:15.814 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:04:15.825 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:04:15.826 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:04:15.828 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:04:15.837 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:04:15.900 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:04:16.198 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:04:16.202 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:04:16.202 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:04:16.204 +00:00 [INF] Hosting environment: Production
2021-02-01 21:04:16.205 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:04:17.531 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:04:17.544 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:04:17.557 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:04:25.306 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:04:25.884 +00:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:06:10.876 +00:00 [INF] Starting web host
2021-02-01 21:06:12.315 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:06:12.530 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:06:12.537 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:06:12.538 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:06:12.541 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:06:12.549 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:06:12.585 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:06:12.887 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:06:12.891 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:06:12.893 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:06:12.894 +00:00 [INF] Hosting environment: Production
2021-02-01 21:06:12.896 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:06:14.406 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:06:14.421 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:06:14.436 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:06:20.104 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:06:20.694 +00:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:11:00.710 +00:00 [INF] Starting web host
2021-02-01 21:11:02.267 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:11:02.472 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:11:02.483 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:11:02.486 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:11:02.489 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:11:02.497 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:11:02.552 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:11:02.838 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:11:02.840 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:11:02.842 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:11:02.843 +00:00 [INF] Hosting environment: Production
2021-02-01 21:11:02.843 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:11:04.303 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:11:04.317 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:11:04.336 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:11:08.762 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:11:09.371 +00:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:11:40.996 +00:00 [INF] Starting web host
2021-02-01 21:11:42.741 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:11:42.971 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:11:42.995 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:11:42.998 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:11:43.003 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:11:43.014 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:11:43.066 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:11:43.385 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:11:43.387 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:11:43.388 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:11:43.389 +00:00 [INF] Hosting environment: Production
2021-02-01 21:11:43.389 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:11:45.101 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:11:45.115 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:11:45.133 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:12:07.749 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:12:08.323 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:13:44.913 +00:00 [INF] Starting web host
2021-02-01 21:13:46.757 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:13:46.995 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:13:47.007 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:13:47.010 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:13:47.013 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:13:47.023 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:13:47.067 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:13:47.400 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:13:47.403 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:13:47.404 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:13:47.404 +00:00 [INF] Hosting environment: Production
2021-02-01 21:13:47.405 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:13:48.560 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:13:48.572 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:13:48.586 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:13:53.390 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:13:53.991 +00:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:19:47.271 +00:00 [INF] Starting web host
2021-02-01 21:19:48.847 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:19:49.113 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:19:49.127 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:19:49.130 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:19:49.136 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:19:49.146 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:19:49.193 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:19:49.518 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:19:49.521 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:19:49.522 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:19:49.523 +00:00 [INF] Hosting environment: Production
2021-02-01 21:19:49.523 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:19:50.758 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:19:50.768 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:19:50.782 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:19:54.281 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:19:54.858 +00:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:24:51.313 +00:00 [INF] Starting web host
2021-02-01 21:24:52.786 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:24:53.026 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:24:53.045 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:24:53.048 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:24:53.051 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:24:53.061 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:24:53.101 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:24:53.370 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:24:53.373 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:24:53.374 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:24:53.374 +00:00 [INF] Hosting environment: Production
2021-02-01 21:24:53.375 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:24:54.798 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:24:54.810 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:24:54.826 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:24:58.041 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:24:58.044 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:24:58.047 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:25:04.403 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:25:05.053 +00:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:26:33.375 +00:00 [INF] Starting web host
2021-02-01 21:26:35.621 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:26:35.899 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:26:35.918 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:26:35.922 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:26:35.925 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:26:35.937 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:26:35.996 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:26:36.317 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:26:36.320 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:26:36.321 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:26:36.322 +00:00 [INF] Hosting environment: Production
2021-02-01 21:26:36.322 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:26:38.005 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:26:38.018 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:26:38.035 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:26:50.244 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:26:50.936 +00:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:31:48.148 +00:00 [INF] Starting web host
2021-02-01 21:31:49.607 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:31:49.807 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:31:49.816 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:31:49.819 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:31:49.820 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:31:49.829 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:31:49.869 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:31:50.164 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:31:50.170 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:31:50.173 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:31:50.174 +00:00 [INF] Hosting environment: Production
2021-02-01 21:31:50.175 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:31:51.468 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:31:51.480 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:31:51.497 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:32:04.606 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:32:05.189 +00:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 21:33:21.386 +00:00 [INF] Starting web host
2021-02-01 21:33:25.205 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 21:33:25.552 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 21:33:25.572 +00:00 [INF] Bus Rebus 1 started
2021-02-01 21:33:25.576 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 21:33:25.579 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 21:33:25.591 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 21:33:25.661 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 21:33:26.230 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 21:33:26.236 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 21:33:26.241 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 21:33:26.252 +00:00 [INF] Hosting environment: Production
2021-02-01 21:33:26.259 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 21:33:28.684 +00:00 [INF] No Api Key found in the request.
2021-02-01 21:33:28.709 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 21:33:28.804 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 21:33:30.763 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 21:33:31.518 +00:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:21:51.675 +00:00 [INF] Starting web host
2021-02-01 22:21:53.262 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:21:53.527 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:21:53.565 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:21:53.569 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:21:53.571 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:21:53.580 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:21:53.619 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:21:53.906 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:21:53.910 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:21:53.911 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:21:53.911 +00:00 [INF] Hosting environment: Production
2021-02-01 22:21:53.912 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:21:55.291 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:21:55.302 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:21:55.313 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:22:02.357 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:22:02.950 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:22:03.121 +00:00 [INF] Executed DbCommand (39ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:22:03.212 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 22:36:35.927 +00:00 [INF] Starting web host
2021-02-01 22:36:37.398 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:36:37.585 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:36:37.598 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:36:37.600 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:36:37.602 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:36:37.613 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:36:37.662 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:36:37.933 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:36:37.938 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:36:37.940 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:36:37.942 +00:00 [INF] Hosting environment: Production
2021-02-01 22:36:37.943 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:36:39.419 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:36:39.430 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:36:39.445 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:36:43.862 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:36:44.422 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:36:44.674 +00:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:36:44.702 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:36:44.848 +00:00 [INF] Executed DbCommand (15ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:36:44.868 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:36:44.875 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:36:44.879 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:37:42.059 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:37:42.074 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:37:42.091 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:37:42.101 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:37:42.102 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:37:42.104 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:38:45.295 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:38:45.305 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:38:45.311 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:38:45.316 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:38:45.329 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 22:39:59.043 +00:00 [INF] Starting web host
2021-02-01 22:40:00.505 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:40:00.724 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:40:00.740 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:40:00.742 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:40:00.743 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:40:00.753 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:40:00.818 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:40:01.095 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:40:01.099 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:40:01.100 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:40:01.101 +00:00 [INF] Hosting environment: Production
2021-02-01 22:40:01.101 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:40:02.613 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:40:02.623 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:40:02.639 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:40:35.362 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:40:35.927 +00:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:40:57.074 +00:00 [ERR] Connection id "0HM67097ROUD9", Request id "0HM67097ROUD9:00000001": An unhandled exception was thrown by the application.
System.Security.Cryptography.CryptographicException: The computed authentication tag did not match the input authentication tag.
   at System.Security.Cryptography.AesAEAD.Decrypt(SafeAlgorithmHandle algorithm, SafeKeyHandle keyHandle, ReadOnlySpan`1 nonce, ReadOnlySpan`1 associatedData, ReadOnlySpan`1 ciphertext, ReadOnlySpan`1 tag, Span`1 plaintext, Boolean clearPlaintextOnFailure)
   at System.Security.Cryptography.AesGcm.Decrypt(Byte[] nonce, Byte[] ciphertext, Byte[] tag, Byte[] plaintext, Byte[] associatedData)
   at PaymentGateway.Services.Services.EncryptionService.Decrypt(String encryptedValue, String keyPrefix, String key) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\EncryptionService.cs:line 35
   at PaymentGateway.Services.Services.SecurityService..ctor(IMerchantsRepository merchantsRepository, IEncryptionService encryptionService, IOptions`1 config) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\SecurityService.cs:line 30
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.ValidateUsingApiKeyProviderAsync(String apiKey)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.AuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationService.AuthenticateAsync(HttpContext context, String scheme)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 22:41:00.390 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:41:00.403 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:41:08.902 +00:00 [ERR] Connection id "0HM67097ROUD9", Request id "0HM67097ROUD9:00000002": An unhandled exception was thrown by the application.
System.Security.Cryptography.CryptographicException: The computed authentication tag did not match the input authentication tag.
   at System.Security.Cryptography.AesAEAD.Decrypt(SafeAlgorithmHandle algorithm, SafeKeyHandle keyHandle, ReadOnlySpan`1 nonce, ReadOnlySpan`1 associatedData, ReadOnlySpan`1 ciphertext, ReadOnlySpan`1 tag, Span`1 plaintext, Boolean clearPlaintextOnFailure)
   at System.Security.Cryptography.AesGcm.Decrypt(Byte[] nonce, Byte[] ciphertext, Byte[] tag, Byte[] plaintext, Byte[] associatedData)
   at PaymentGateway.Services.Services.EncryptionService.Decrypt(String encryptedValue, String keyPrefix, String key) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\EncryptionService.cs:line 35
   at PaymentGateway.Services.Services.SecurityService..ctor(IMerchantsRepository merchantsRepository, IEncryptionService encryptionService, IOptions`1 config) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\SecurityService.cs:line 30
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.ValidateUsingApiKeyProviderAsync(String apiKey)
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at AspNetCore.Authentication.ApiKey.ApiKeyHandlerBase.HandleAuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.AuthenticateAsync()
   at Microsoft.AspNetCore.Authentication.AuthenticationService.AuthenticateAsync(HttpContext context, String scheme)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2021-02-01 22:41:11.593 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:41:11.600 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:42:02.168 +00:00 [INF] Starting web host
2021-02-01 22:42:04.217 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:42:04.402 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:42:04.411 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:42:04.414 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:42:04.415 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:42:04.426 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:42:04.478 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:42:04.761 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:42:04.766 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:42:04.767 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:42:04.768 +00:00 [INF] Hosting environment: Production
2021-02-01 22:42:04.768 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:42:06.014 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:42:06.024 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:42:06.039 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:42:11.322 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:42:11.922 +00:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:43:39.968 +00:00 [INF] Starting web host
2021-02-01 22:43:41.305 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:43:41.513 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:43:41.530 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:43:41.533 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:43:41.536 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:43:41.548 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:43:41.627 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:43:41.901 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:43:41.906 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:43:41.907 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:43:41.908 +00:00 [INF] Hosting environment: Production
2021-02-01 22:43:41.909 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:43:43.819 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:43:43.829 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:43:43.840 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:44:23.355 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:44:23.942 +00:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:44:24.209 +00:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:44:24.239 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:44:24.394 +00:00 [INF] Executed DbCommand (17ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:44:24.425 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:44:24.432 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:44:24.438 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:44:57.566 +00:00 [INF] Starting web host
2021-02-01 22:44:59.090 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:44:59.273 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:44:59.287 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:44:59.292 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:44:59.294 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:44:59.303 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:44:59.359 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:44:59.659 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:44:59.662 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:44:59.663 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:44:59.664 +00:00 [INF] Hosting environment: Production
2021-02-01 22:44:59.665 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:45:01.427 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:45:01.437 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:45:01.451 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:45:11.871 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:45:12.492 +00:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:46:35.698 +00:00 [INF] Starting web host
2021-02-01 22:46:37.069 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:46:37.267 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:46:37.290 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:46:37.293 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:46:37.294 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:46:37.304 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:46:37.372 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:46:37.647 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:46:37.652 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:46:37.652 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:46:37.653 +00:00 [INF] Hosting environment: Production
2021-02-01 22:46:37.654 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:46:39.170 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:46:39.179 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:46:39.194 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:46:51.129 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:46:51.763 +00:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:47:37.085 +00:00 [INF] Executed DbCommand (43ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:47:37.104 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:47:37.114 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:47:37.121 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:47:40.593 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:47:40.601 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:48:55.223 +00:00 [INF] Starting web host
2021-02-01 22:48:56.713 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:48:56.923 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:48:56.931 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:48:56.933 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:48:56.935 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:48:56.946 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:48:56.987 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:48:57.334 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:48:57.341 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:48:57.347 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:48:57.349 +00:00 [INF] Hosting environment: Production
2021-02-01 22:48:57.351 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:48:58.907 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:48:58.927 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:48:58.939 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:49:39.401 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:49:40.247 +00:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:49:46.477 +00:00 [INF] Executed DbCommand (36ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:49:46.493 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:49:46.500 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:49:46.507 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:49:55.940 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:49:55.945 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:49:55.954 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 22:49:55.957 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:49:55.958 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 22:49:55.964 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:50:03.021 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:50:03.026 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:51:55.799 +00:00 [INF] Starting web host
2021-02-01 22:51:57.740 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:51:57.980 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:51:57.992 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:51:57.995 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:51:57.997 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:51:58.009 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:51:58.051 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:51:58.336 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:51:58.340 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:51:58.342 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:51:58.343 +00:00 [INF] Hosting environment: Production
2021-02-01 22:51:58.345 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:52:00.114 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:52:00.131 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:52:00.160 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:52:00.462 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:52:01.330 +00:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:54:47.457 +00:00 [INF] Starting web host
2021-02-01 22:54:49.142 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 22:54:49.337 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 22:54:49.363 +00:00 [INF] Bus Rebus 1 started
2021-02-01 22:54:49.365 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 22:54:49.369 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 22:54:49.382 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 22:54:49.447 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 22:54:49.762 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 22:54:49.767 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 22:54:49.768 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 22:54:49.769 +00:00 [INF] Hosting environment: Production
2021-02-01 22:54:49.770 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 22:54:51.537 +00:00 [INF] No Api Key found in the request.
2021-02-01 22:54:51.546 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 22:54:51.556 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 22:55:09.448 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 22:55:10.056 +00:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 22:55:10.358 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:55:10.388 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 22:55:53.985 +00:00 [INF] Executed DbCommand (20ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:07:46.605 +00:00 [INF] Starting web host
2021-02-01 23:07:48.558 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:07:48.768 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:07:48.779 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:07:48.782 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:07:48.785 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:07:48.795 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:07:48.851 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:07:49.167 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:07:49.172 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:07:49.173 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:07:49.173 +00:00 [INF] Hosting environment: Production
2021-02-01 23:07:49.174 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:07:50.987 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:07:51.001 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:07:51.022 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:08:52.080 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:08:52.701 +00:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:08:52.875 +00:00 [INF] Executed DbCommand (36ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[Id] = @__id_0
2021-02-01 23:08:52.980 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 23:08:52.987 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 23:08:52.993 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:09:02.002 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:09:02.008 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:09:02.022 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[Id] = @__id_0
2021-02-01 23:09:02.037 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:09:02.742 +00:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:09:03.038 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:09:03.052 +00:00 [DBG] Initializing new model
2021-02-01 23:09:03.095 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:09:03.201 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:09:03.207 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:09:03.219 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[Id] = @__id_0
2021-02-01 23:09:03.230 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:09:03.265 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:09:31.937 +00:00 [INF] Starting web host
2021-02-01 23:09:33.427 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:09:33.662 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:09:33.672 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:09:33.675 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:09:33.677 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:09:33.691 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:09:33.728 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:09:33.993 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:09:33.997 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:09:33.999 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:09:34.001 +00:00 [INF] Hosting environment: Production
2021-02-01 23:09:34.002 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:09:35.431 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:09:35.442 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:09:35.455 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:26:19.696 +00:00 [INF] Starting web host
2021-02-01 23:26:21.498 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:26:21.738 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:26:21.751 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:26:21.753 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:26:21.755 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:26:21.769 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:26:21.823 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:26:22.178 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:26:22.183 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:26:22.185 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:26:22.187 +00:00 [INF] Hosting environment: Production
2021-02-01 23:26:22.190 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:26:23.970 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:26:23.997 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:26:24.014 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:26:25.641 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:26:26.259 +00:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:26:26.439 +00:00 [INF] Executed DbCommand (40ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:26:26.461 +00:00 [ERR] Invalid API Key provided by IApiKeyProvider.
2021-02-01 23:26:26.470 +00:00 [INF] ApiKey was not authenticated. Failure message: Invalid API Key provided by IApiKeyProvider.
2021-02-01 23:26:26.474 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:26:47.950 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:26:47.958 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:26:48.149 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:26:48.174 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Merchants] ([ApiKey], [CompanyName], [ContactName], [EmailAddress], [EncryptionKey])
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT [Id]
FROM [Merchants]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:26:48.203 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:26:48.218 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:26:48.690 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:26:48.885 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:26:48.898 +00:00 [DBG] Initializing new model
2021-02-01 23:26:48.936 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:26:49.021 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:26:49.029 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:26:49.036 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:26:49.042 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:26:49.070 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:30:16.391 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:30:16.405 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:30:16.423 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:30:16.428 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:30:16.442 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:30:16.450 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:30:16.461 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:30:16.470 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:30:16.476 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:30:16.480 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:30:16.482 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:30:16.486 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:30:41.648 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:30:41.650 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:30:41.653 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:30:57.819 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:30:57.828 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:30:57.844 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:30:57.855 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:30:57.863 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:31:07.411 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:31:07.418 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:31:07.424 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:31:07.433 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:31:07.438 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:39:37.416 +00:00 [INF] Starting web host
2021-02-01 23:39:39.281 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:39:39.515 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:39:39.533 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:39:39.536 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:39:39.543 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:39:39.553 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:39:39.608 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:39:39.939 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:39:39.943 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:39:39.944 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:39:39.944 +00:00 [INF] Hosting environment: Production
2021-02-01 23:39:39.945 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:39:41.526 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:39:41.538 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:39:41.555 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:39:48.255 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:39:48.933 +00:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:39:49.141 +00:00 [INF] Executed DbCommand (41ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:39:49.243 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:39:49.579 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:39:49.770 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:39:49.775 +00:00 [DBG] Could not find Payment with id 3
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 3
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:40:02.385 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:40:02.398 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:40:02.410 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:40:02.424 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:02.430 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:40:02.542 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:02.545 +00:00 [DBG] Could not find Payment with id 3
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 3
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:40:06.304 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:40:06.310 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:40:06.317 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:40:06.326 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:06.330 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:40:06.429 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:06.431 +00:00 [DBG] Could not find Payment with id 3
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 3
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:40:19.990 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:40:19.995 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:40:20.005 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:40:20.010 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:20.018 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:40:20.120 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:20.124 +00:00 [DBG] Could not find Payment with id 3
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 3
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:40:27.732 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:40:27.737 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:40:27.753 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:40:27.767 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:27.773 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:40:27.890 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:40:27.894 +00:00 [DBG] Could not find Payment with id 3
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 3
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:41:23.269 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:41:23.280 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:41:23.284 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:41:23.290 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:44:24.801 +00:00 [INF] Starting web host
2021-02-01 23:44:26.786 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:44:27.029 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:44:27.042 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:44:27.046 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:44:27.048 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:44:27.060 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:44:27.104 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:44:27.441 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:44:27.444 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:44:27.445 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:44:27.446 +00:00 [INF] Hosting environment: Production
2021-02-01 23:44:27.447 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:44:29.384 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:44:29.463 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:44:29.509 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:44:31.080 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:44:31.773 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:44:31.775 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:44:31.778 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:44:31.817 +00:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:44:32.041 +00:00 [INF] Executed DbCommand (44ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:44:32.152 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:44:40.257 +00:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:44:40.527 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:44:40.543 +00:00 [DBG] Initializing new model
2021-02-01 23:44:40.581 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:44:40.709 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:44:40.713 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:44:40.722 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:44:40.726 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:44:40.757 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:44:40.916 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:44:40.922 +00:00 [DBG] Could not find Payment with id 4
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 4
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:46:01.956 +00:00 [INF] Starting web host
2021-02-01 23:46:03.255 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:46:03.455 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:46:03.470 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:46:03.472 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:46:03.474 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:46:03.485 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:46:03.522 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:46:03.801 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:46:03.805 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:46:03.806 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:46:03.807 +00:00 [INF] Hosting environment: Production
2021-02-01 23:46:03.808 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:46:05.321 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:46:05.334 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:46:05.351 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:46:23.971 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:46:24.550 +00:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:46:24.726 +00:00 [INF] Executed DbCommand (39ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:46:24.827 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:46:25.433 +00:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:46:25.639 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:46:25.650 +00:00 [DBG] Initializing new model
2021-02-01 23:46:25.683 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:46:25.814 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:46:25.824 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:46:25.834 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:46:25.842 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:46:25.876 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:46:26.105 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:46:26.109 +00:00 [DBG] Could not find Payment with id 5
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 5
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 55
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:48:07.987 +00:00 [INF] Starting web host
2021-02-01 23:48:12.302 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:48:12.680 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:48:12.699 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:48:12.702 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:48:12.706 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:48:12.723 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:48:12.790 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:48:13.253 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:48:13.260 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:48:13.262 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:48:13.264 +00:00 [INF] Hosting environment: Production
2021-02-01 23:48:13.266 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:48:15.156 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:48:15.412 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:48:15.422 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:48:15.448 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:48:16.503 +00:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:48:16.828 +00:00 [INF] Executed DbCommand (61ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:48:16.946 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:48:17.922 +00:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:48:18.300 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:48:18.319 +00:00 [DBG] Initializing new model
2021-02-01 23:48:18.372 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:48:18.531 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:48:18.541 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:48:18.574 +00:00 [INF] Executed DbCommand (12ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:48:18.589 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:48:18.638 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:49:26.054 +00:00 [INF] Starting web host
2021-02-01 23:49:27.494 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:49:27.698 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:49:27.707 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:49:27.709 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:49:27.710 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:49:27.718 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:49:27.753 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:49:28.024 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:49:28.027 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:49:28.028 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:49:28.028 +00:00 [INF] Hosting environment: Production
2021-02-01 23:49:28.029 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:49:29.885 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:49:29.903 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:49:29.925 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:49:49.318 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:49:49.885 +00:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:49:50.058 +00:00 [INF] Executed DbCommand (37ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:49:50.151 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:49:50.740 +00:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:49:50.953 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:49:50.966 +00:00 [DBG] Initializing new model
2021-02-01 23:49:51.005 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:49:51.137 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:49:51.142 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:49:51.156 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:49:51.166 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:49:51.193 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:50:09.212 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:09.217 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:09.224 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:09.229 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:09.236 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:50:09.395 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:09.403 +00:00 [DBG] Could not find Payment with id 7
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 7
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 54
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:50:22.569 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:22.579 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:22.596 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:22.617 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:22.624 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:50:37.007 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:37.021 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:37.030 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:37.036 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:37.051 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Precision = 19) (Scale = 4) (DbType = Decimal), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [BankPaymentId], [CardExpiry], [CardFullName], [CardNumber], [Currency], [MerchantId], [Processed], [Status], [Submitted])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT [Id]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2021-02-01 23:50:37.063 +00:00 [DBG] Sending PaymentGateway.Messages.Commands.SubmitPaymentCommand -> PaymentGateway.Messages.Commands.SubmitPaymentCommand, PaymentGateway.Messages@RebusTopics
2021-02-01 23:50:37.071 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Payments] SET [Status] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
2021-02-01 23:50:37.084 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:37.088 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:37.092 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:37.095 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:37.100 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:50:44.474 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:44.483 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:44.495 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:44.503 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:44.516 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:50:44.624 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:44.627 +00:00 [DBG] Could not find Payment with id 7
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 7
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 54
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:50:48.529 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:50:48.535 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:50:48.541 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:50:48.546 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:50:48.553 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:51:13.471 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:51:13.478 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:51:13.485 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:51:13.494 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:51:13.499 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[Id] = @__id_0
2021-02-01 23:51:13.615 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:51:13.618 +00:00 [DBG] Could not find Payment with id 8
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 8
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 54
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordById(Int32 id) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:51:43.182 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:51:43.188 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:51:43.199 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:51:43.213 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:51:55.744 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:51:55.752 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:51:55.762 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:51:55.775 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:52:07.857 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:52:07.862 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:52:07.873 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:52:07.877 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:52:51.188 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:52:51.194 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:52:51.202 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:52:51.211 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:52:51.225 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:52:51.245 +00:00 [ERR] An exception occurred while iterating over the results of a query for context type 'PaymentGateway.Data.PaymentsContext'.
System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.ThrowIfNull()
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.ThrowIfNull()
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2021-02-01 23:52:51.452 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:52:51.454 +00:00 [ERR] Data is Null. This method or property cannot be called on Null values.
System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.ThrowIfNull()
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at PaymentGateway.Data.Repositories.PaymentsRepository.GetPayment(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Data\Repositories\PaymentsRepository.cs:line 40
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 60
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:53:06.727 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:53:06.736 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:53:06.745 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:53:06.752 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:06.758 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:53:06.854 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:06.857 +00:00 [DBG] Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 66
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:53:21.387 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:53:21.392 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:53:21.405 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:53:21.411 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:21.422 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:53:21.525 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:21.528 +00:00 [DBG] Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 66
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:53:35.249 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:53:35.256 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:53:35.264 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:53:35.272 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:35.281 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:53:35.375 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:53:35.377 +00:00 [DBG] Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id 7a62860e-4bac-4a6d-8595-6d365aacd26c
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 66
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:54:10.373 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:54:10.378 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:54:10.388 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:54:10.392 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:54:10.396 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:54:10.490 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:54:10.493 +00:00 [DBG] Could not find Payment with id e97ea316-371e-4087-89c2-066b0dcc0c43
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id e97ea316-371e-4087-89c2-066b0dcc0c43
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 66
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2021-02-01 23:54:30.927 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:54:30.933 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:54:30.951 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:54:30.965 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:54:37.625 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:54:56.148 +00:00 [INF] Starting web host
2021-02-01 23:54:57.544 +00:00 [INF] Initializing RabbitMQ connection manager for transport with input queue PaymentsDefaultQueue
2021-02-01 23:54:57.747 +00:00 [INF] Starting periodic task CleanupTrackedErrors with interval "00:00:10"
2021-02-01 23:54:57.767 +00:00 [INF] Bus Rebus 1 started
2021-02-01 23:54:57.770 +00:00 [INF] Bus Rebus 1 setting number of workers to 1
2021-02-01 23:54:57.772 +00:00 [DBG] Adding worker Rebus 1 worker 1
2021-02-01 23:54:57.782 +00:00 [DBG] Starting (threadpool-based) worker Rebus 1 worker 1
2021-02-01 23:54:57.826 +00:00 [INF] Successfully initialized consumer for PaymentsDefaultQueue
2021-02-01 23:54:58.106 +00:00 [INF] Now listening on: https://localhost:5001
2021-02-01 23:54:58.110 +00:00 [INF] Now listening on: http://localhost:5000
2021-02-01 23:54:58.111 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2021-02-01 23:54:58.111 +00:00 [INF] Hosting environment: Production
2021-02-01 23:54:58.112 +00:00 [INF] Content root path: C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api
2021-02-01 23:54:59.777 +00:00 [INF] No Api Key found in the request.
2021-02-01 23:54:59.793 +00:00 [DBG] AuthenticationScheme: ApiKey was not authenticated.
2021-02-01 23:54:59.808 +00:00 [INF] AuthenticationScheme: ApiKey was challenged.
2021-02-01 23:55:16.592 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:55:17.190 +00:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:55:17.359 +00:00 [INF] Executed DbCommand (36ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:55:17.443 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:55:20.756 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:55:33.454 +00:00 [INF] Entity Framework Core 5.0.2 initialized 'PaymentsContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-02-01 23:55:33.464 +00:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Merchants] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-02-01 23:55:33.472 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__apiKey_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[ApiKey], [m].[CompanyName], [m].[ContactName], [m].[EmailAddress], [m].[EncryptionKey]
FROM [Merchants] AS [m]
WHERE [m].[ApiKey] = @__apiKey_0
2021-02-01 23:55:33.479 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:55:35.494 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bankPaymentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[Amount], [p].[BankPaymentId], [p].[CardExpiry], [p].[CardFullName], [p].[CardNumber], [p].[Currency], [p].[MerchantId], [p].[Processed], [p].[Status], [p].[Submitted]
FROM [Payments] AS [p]
WHERE [p].[BankPaymentId] = @__bankPaymentId_0
2021-02-01 23:55:35.642 +00:00 [DBG] AuthenticationScheme: ApiKey was successfully authenticated.
2021-02-01 23:55:35.648 +00:00 [DBG] Could not find Payment with id e97ea316-371e-4087-89c2-066b0dcc0c43
PaymentGateway.Services.Exceptions.NotFoundException: Could not find Payment with id e97ea316-371e-4087-89c2-066b0dcc0c43
   at PaymentGateway.Services.Services.PaymentService.GetPaymentRecord(Guid bankPaymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGateway.Services\Services\PaymentService.cs:line 66
   at PaymentGateway.Api.Controllers.PaymentsController.GetPaymentRecordByBankPaymentId(Nullable`1 paymentId) in C:\Users\Jamal Osman\Source\Repos\PaymentGatewayExercise\PaymentGatewayExercise.Api\Controllers\PaymentsController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
